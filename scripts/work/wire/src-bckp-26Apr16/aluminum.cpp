/*
  aluminum.cpp  translated from aluminum.f
  
  by Wei Cai  caiwei@mit.edu, Maurice de Koning maurice@mit.edu
  Last Modified : Mon Feb  4 09:58:29 2002

  FUNCTION  : MD++ implementation of Al Glue potential
              (Ercolessi-Adams Glue potential)
*/

void seval(int n,double u,double *x, double *y,
           double *b, double *c, double *d,
           double *f, double *df, double *d2f);

void v2(double arg, double *func, double *dfunc, double *d2func)
{
#define nv2 17
    double xv2[nv2]=
    {
         .202111069753385e+01  ,
         .227374953472558e+01  ,
         .252638837191732e+01  ,
         .277902720910905e+01  ,
         .303166604630078e+01  ,
         .328430488349251e+01  ,
         .353694372068424e+01  ,
         .378958255787597e+01  ,
         .404222139506771e+01  ,
         .429486023225944e+01  ,
         .454749906945117e+01  ,
         .480013790664290e+01  ,
         .505277674383463e+01  ,
         .530541558102636e+01  ,
         .555805441821810e+01  ,
         .555807968210182e+01  ,
         .555810494598553e+01  ,
    };
    double yv2[nv2]=
    {
         .196016472197158e+01  ,
         .682724240745344e+00  ,
         .147370824539188e+00  ,
        -.188188235860390e-01  ,
        -.576011902692490e-01  ,
        -.519846499644276e-01  ,
        -.376352484845919e-01  ,
        -.373737879689433e-01  ,
        -.531351030124350e-01  ,
        -.632864983555742e-01  ,
        -.548103623840369e-01  ,
        -.372889232343935e-01  ,
        -.188876517630154e-01  ,
        -.585239362533525e-02  ,
         .000000000000000e+00  ,
         .000000000000000e+00  ,
         .000000000000000e+00  ,
    };
    double bv2[nv2]=
    {
        -.702739315585347e+01  ,
        -.333140549270729e+01  ,
        -.117329394261502e+01  ,
        -.306003283486901e+00  ,
        -.366656699104026e-01  ,
         .588330899204400e-01  ,
         .384220572312032e-01  ,
        -.390223173707191e-01  ,
        -.663882722510521e-01  ,
        -.312918894386669e-02  ,
         .590118945294245e-01  ,
         .757939459148246e-01  ,
         .643822548468606e-01  ,
         .399750987463792e-01  ,
         .177103852679117e-05  ,
        -.590423369301474e-06  ,
         .590654950414731e-06  ,
    };
    double cv2[nv2]=
    {
         .877545959718548e+01  ,
         .585407125495837e+01  ,
         .268820820643116e+01  ,
         .744718689404422e+00  ,
         .321378734769888e+00  ,
         .566263292669091e-01  ,
        -.137417679148505e+00  ,
        -.169124163201523e+00  ,
         .608037039066423e-01  ,
         .189589640245655e+00  ,
         .563784150384640e-01  ,
         .100486298765028e-01  ,
        -.552186092621482e-01  ,
        -.413902746758285e-01  ,
        -.116832934994489e+00  ,
         .233610871054729e-01  ,
         .233885865725971e-01  ,
    };
    double dv2[nv2]=
    {
        -.385449887634130e+01  ,
        -.417706040200591e+01  ,
        -.256425277368288e+01  ,
        -.558557503589276e+00  ,
        -.349316054551627e+00  ,
        -.256022933201611e+00  ,
        -.418337423301704e-01  ,
         .303368330939646e+00  ,
         .169921006301015e+00  ,
        -.175759761362548e+00  ,
        -.611278214082881e-01  ,
        -.861140219824535e-01  ,
         .182451950513387e-01  ,
        -.995395392057973e-01  ,
         .184972909229936e+04  ,
         .362829766922787e+00  ,
         .362829766922787e+00  ,
    };
    double argmax;

    argmax=.555805441821810e+01;
    
    if(arg>=argmax)
    {
        *func = *dfunc = *d2func = 0;
    }
    else
    {
        seval(nv2,arg,xv2,yv2,bv2,cv2,dv2,func,dfunc,d2func);
    }
}




void rh(double arg, double *func, double *dfunc, double *d2func)
{
#define nrh 17
    double xrh[nrh]=
    {
         .202111069753385e+01  ,
         .227374953472558e+01  ,
         .252638837191732e+01  ,
         .277902720910905e+01  ,
         .303166604630078e+01  ,
         .328430488349251e+01  ,
         .353694372068424e+01  ,
         .378958255787597e+01  ,
         .404222139506771e+01  ,
         .429486023225944e+01  ,
         .454749906945117e+01  ,
         .480013790664290e+01  ,
         .505277674383463e+01  ,
         .530541558102636e+01  ,
         .555805441821810e+01  ,
         .555807968210182e+01  ,
         .555810494598553e+01  ,
    };
    double yrh[nrh]=
    {
         .865674623712589e-01  ,
         .925214702944478e-01  ,
         .862003123832002e-01  ,
         .762736292751052e-01  ,
         .606481841271735e-01  ,
         .466030959588197e-01  ,
         .338740138848363e-01  ,
         .232572661705343e-01  ,
         .109046405489829e-01  ,
         .524910605677597e-02  ,
         .391702419142291e-02  ,
         .308277776293383e-02  ,
         .250214745349505e-02  ,
         .147220513798186e-02  ,
         .000000000000000e+00  ,
         .000000000000000e+00  ,
         .000000000000000e+00  ,
    };
    double brh[nrh]=
    {
         .608555214104682e-01  ,
        -.800158928716306e-02  ,
        -.332089451111092e-01  ,
        -.521001991705069e-01  ,
        -.618130637429111e-01  ,
        -.529750064268036e-01  ,
        -.442210477548108e-01  ,
        -.473645664984640e-01  ,
        -.390741582571631e-01  ,
        -.101795580610560e-01  ,
        -.318316981110289e-02  ,
        -.281217210746153e-02  ,
        -.236932031483360e-02  ,
        -.683554708271547e-02  ,
        -.638718204858808e-06  ,
         .212925486831149e-06  ,
        -.212983742465787e-06  ,
    };
    double crh[nrh]=
    {
        -.170233687052940e+00  ,
        -.102317878901959e+00  ,
         .254162872544396e-02  ,
        -.773173610292656e-01  ,
         .388717099948882e-01  ,
        -.388873819867093e-02  ,
         .385388290924526e-01  ,
        -.509815666327127e-01  ,
         .837968231208082e-01  ,
         .305743500420042e-01  ,
        -.288110886134041e-02  ,
         .434959924771674e-02  ,
        -.259669459714693e-02  ,
        -.150816117849093e-01  ,
         .421356801161513e-01  ,
        -.842575249165724e-02  ,
        -.843267014952237e-02  ,
    };
    double drh[nrh]=
    {
         .896085612514625e-01  ,
         .138352319847830e+00  ,
        -.105366473134009e+00  ,
         .153300619856764e+00  ,
        -.564184148788224e-01  ,
         .559792096400504e-01  ,
        -.118113795329664e+00  ,
         .177827488509794e+00  ,
        -.702220789044304e-01  ,
        -.441413511810337e-01  ,
         .954024354744484e-02  ,
        -.916498550800407e-02  ,
        -.164726813535368e-01  ,
         .754928689733184e-01  ,
        -.667110847110954e+03  ,
        -.912720300911022e-01  ,
        -.912720300911022e-01  ,
    };
    double argmax;

    argmax=.555805441821810e+01;
    
    if(arg>=argmax)
    {
        *func = *dfunc = *d2func = 0;
    }
    else
    {
        seval(nrh,arg,xrh,yrh,brh,crh,drh,func,dfunc,d2func);
    }
}





void uu(double arg, double *func, double *dfunc, double *d2func)
{
#define nuu 13
    double xuu[nuu]=
    {
         .000000000000000e+00  ,
         .100000000000000e+00  ,
         .200000000000000e+00  ,
         .300000000000000e+00  ,
         .400000000000000e+00  ,
         .500000000000000e+00  ,
         .600000000000000e+00  ,
         .700000000000000e+00  ,
         .800000000000000e+00  ,
         .900000000000000e+00  ,
         .100000000000000e+01  ,
         .110000000000000e+01  ,
         .120000000000000e+01  ,
    };
    double yuu[nuu]=
    {
         .000000000000000e+00  ,
        -.113953324143752e+01  ,
        -.145709859805864e+01  ,
        -.174913308002738e+01  ,
        -.202960322136630e+01  ,
        -.225202324967546e+01  ,
        -.242723053979436e+01  ,
        -.255171976467357e+01  ,
        -.260521638832322e+01  ,
        -.264397894381693e+01  ,
        -.265707884842034e+01  ,
        -.264564149400021e+01  ,
        -.260870604452106e+01  ,
    };
    double buu[nuu]=
    {
        -.183757286015853e+02  ,
        -.574233124410516e+01  ,
        -.236790436375322e+01  ,
        -.307404645857774e+01  ,
        -.251104850116555e+01  ,
        -.196846462620234e+01  ,
        -.154391254686695e+01  ,
        -.846780636273251e+00  ,
        -.408540363905760e+00  ,
        -.286833282404628e+00  ,
        -.309389414590161e-06  ,
         .236958014464143e+00  ,
         .503352368511243e+00  ,
    };
    double cuu[nuu]=
    {
         .830779120415016e+02  ,
         .432560615333001e+02  ,
        -.951179272978074e+01  ,
         .245037178153561e+01  ,
         .317960779258630e+01  ,
         .224623095704576e+01  ,
         .199928983630817e+01  ,
         .497202926962879e+01  ,
        -.589626545953876e+00  ,
         .180669736096520e+01  ,
         .106163236918694e+01  ,
         .130795086934864e+01  ,
         .135599267112235e+01  ,
    };
    double duu[nuu]=
    {
        -.132739501694005e+03  ,
        -.175892847543603e+03  ,
         .398738817043878e+02  ,
         .243078670350231e+01  ,
        -.311125611846847e+01  ,
        -.823137069125319e+00  ,
         .990913144440207e+01  ,
        -.185388527186089e+02  ,
         .798774635639692e+01  ,
        -.248354997259420e+01  ,
         .821061667205675e+00  ,
         .160139339245701e+00  ,
         .160139339245701e+00  ,
    };        
    double argmin;

    argmin=0;
    
    if(arg<=argmin)
    {
        *func = *dfunc = *d2func = 0;
    }
    else
    {
        seval(nuu,arg,xuu,yuu,buu,cuu,duu,func,dfunc,d2func);
    }

}


void seval(int n,double u,double *x, double *y,
           double *b, double *c, double *d,
           double *f, double *df, double *d2f)
{
    int i, j, k;
    double dx;

    i=0;
    if ( i>=n ) i = 0;    
    if ( u<x[i] ) goto line10;
    if ( u<=x[i+1] ) goto line30;
 line10:
    i = 0;
    j = n;
 line20:
    k = (i+j)/2;
    if ( u<x[k] ) j = k;
    if ( u>=x[k] ) i = k;
    if ( j>(i+1) ) goto line20;
 line30:
    dx = u - x[i];
    *f = y[i] + dx*(b[i] + dx*(c[i] + dx*d[i]));
    *df = b[i] + dx*(2.0*c[i] + 3.0*dx*d[i]);
    *d2f = 2.0*c[i] + 6.0*dx*d[i];
}
